{"version":3,"file":"ExtractFieldNamesVisitor.js","names":["ExtractFieldNamesVisitor","fieldNamesSet","Set","ctx","expr","add","field","getText","complex","countComplex","DISTINCT","T6TriggerVisitor"],"sources":["../src/ExtractFieldNamesVisitor.ts"],"sourcesContent":["import T6TriggerVisitor from './gen/T6TriggerVisitor';\nimport {\n  ParseCtx,\n  ComparatorExprCtx,\n  ValueExprCtx,\n  ValuesExprCtx,\n  NotExprCtx,\n  EmptyExprCtx,\n  AnyExprCtx,\n  NumberExprCtx,\n  BinaryExprCtx,\n  NumbersExprCtx,\n  ParenExprCtx,\n  ComplexExprCtx,\n  CountExprCtx,\n  VehicleImpactExprCtx,\n  CountComplexExprCtx,\n} from './types';\n\nexport class ExtractFieldNamesVisitor extends T6TriggerVisitor {\n  private readonly fieldNamesSet: Set<string>;\n\n  constructor() {\n    super();\n    this.fieldNamesSet = new Set();\n  }\n\n  override visitParse(ctx: ParseCtx) {\n    super.visit(ctx.expr());\n    return null;\n  }\n\n  override visitValueExpr(ctx: ValueExprCtx) {\n    this.fieldNamesSet.add(ctx.field().getText());\n    return null;\n  }\n\n  override visitValuesExpr(ctx: ValuesExprCtx) {\n    this.fieldNamesSet.add(ctx.field().getText());\n    return null;\n  }\n\n  override visitComparatorExpr(ctx: ComparatorExprCtx) {\n    this.fieldNamesSet.add(ctx.field().getText());\n    return null;\n  }\n\n  override visitAnyExpr(ctx: AnyExprCtx) {\n    this.fieldNamesSet.add(ctx.field().getText());\n    return null;\n  }\n\n  override visitEmptyExpr(ctx: EmptyExprCtx) {\n    this.fieldNamesSet.add(ctx.field().getText());\n    return super.visitEmptyExpr(ctx);\n  }\n\n  override visitNotExpr(ctx: NotExprCtx) {\n    this.fieldNamesSet.add(ctx.field().getText());\n    return null;\n  }\n\n  override visitNumberExpr(ctx: NumberExprCtx) {\n    this.fieldNamesSet.add(ctx.field().getText());\n    return null;\n  }\n\n  override visitBinaryExpr(ctx: BinaryExprCtx) {\n    super.visit(ctx.expr(0));\n    super.visit(ctx.expr(1));\n    return null;\n  }\n\n  override visitNumbersExpr(ctx: NumbersExprCtx) {\n    this.fieldNamesSet.add(ctx.field().getText());\n    return null;\n  }\n\n  override visitParenExpr(ctx: ParenExprCtx) {\n    super.visit(ctx.expr());\n    return null;\n  }\n\n  override visitComplexExpr(ctx: ComplexExprCtx) {\n    this.fieldNamesSet.add(ctx.field().getText());\n    super.visit(ctx.complex().expr());\n    return null;\n  }\n\n  override visitCountExpr(ctx: CountExprCtx) {\n    this.fieldNamesSet.add(ctx.field().getText());\n    return null;\n  }\n\n  override visitCountComplexExpr(ctx: CountComplexExprCtx) {\n    this.fieldNamesSet.add(ctx.field().getText());\n\n    if (ctx.countComplex().DISTINCT() !== null) {\n      this.fieldNamesSet.add(ctx.countComplex().field().getText());\n    }\n\n    super.visit(ctx.countComplex().expr());\n    return null;\n  }\n\n  override visitVehicleImpactExpr(ctx: VehicleImpactExprCtx) {\n    this.fieldNamesSet.add(ctx.field().getText());\n    return null;\n  }\n\n  get fieldNames(): string[] {\n    return [...this.fieldNamesSet];\n  }\n}\n"],"mappings":"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"}